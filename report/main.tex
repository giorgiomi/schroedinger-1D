\documentclass[a4paper, titlepage]{article}
\input{packages}

%%% Il documento vero e proprio %%%
\begin{document}
\input{frontespizio}
\newcommand{\sch}[0]{Schrödinger }

\section{Introduzione}
L'obiettivo di questo progetto è risolvere numericamente l'equazione di Schrödinger in una dimensione:
\begin{equation}
    i\frac{\partial}{\partial t}\psi(x,t) = \left[-\frac{\partial^2}{\partial x^2} + V(x)\right]\psi(x,t)\, .
    \label{eq:sch}
\end{equation}
Per semplicità, si sono posti $\hbar = m = 1$. Si è interessati alla regione $x \in [-L,L]$ e si impongono le condizioni al contorno $\psi(-L,t) = \psi(L,t) = 0$.

\subsection{Metodo di Eulero esplicito}
Il primo approccio è quello di utilizzare il metodo di Eulero esplicito. 
Per prima cosa, si usano le differenze finite per stimare le derivate della funzione d'onda che compaiono in \eqref{eq:sch}. Siano $x = x_0 + \Delta x$ e $t = t_0 + \Delta t$, si ottiene:
\begin{align*}
    &\pdv{\psi(x, t)}{t} = \frac{\psi(x_0, t_0 + \Delta t) - \psi(x_0, t_0)}{\Delta t} + \mathcal{O}(\Delta t)\, , \\
    &\pdv[2]{\psi(x, t)}{x} = \frac{\psi(x_0 + \Delta x, t_0) - 2\psi(x_0, t_0) + \psi(x_0 - \Delta x, t)}{\Delta x^2} + \mathcal{O}(\Delta x^2)\, .
\end{align*}
L'equazione di Schrödinger diventa quindi:
\begin{equation*}
    i \frac{\psi(x_0, t_0 + \Delta t) - \psi(x_0, t_0)}{\Delta t} = 
    - \frac{\psi(x_0 + \Delta x, t_0) - 2\psi(x_0, t_0) + \psi(x_0 - \Delta x, t_0)}{\Delta x^2} + V(x_0)\psi(x_0, t_0)\, .
\end{equation*}
Prendendo $\Delta x = 2L/(N+1)$, si possono definire la funzione d'onda e il potenziale calcolati sui punti della griglia come
\begin{align*}
    &\psi_i^k = \psi(-L + i\Delta x, t_0 + k\Delta t) \qquad i = 0,1,\dots,N+1 \quad k = 0,1,\dots,M \\
    &V_i = V(-L + i\Delta x) \qquad\qquad\qquad\ i = 0,1,\dots,N+1
\end{align*}
e si può scrivere l'equazione in modo più chiaro:
\begin{equation*}
    i \frac{\psi_i^{k+1} - \psi_i^k}{\Delta t} = 
    - \frac{\psi_{i+1}^k - 2\psi_i^k + \psi_{i-1}^k}{\Delta x^2} + V_i\psi_i^k\, .
\end{equation*}
Isolando il termine $\psi_i^{k+1}$ e semplificando, si ottiene
\begin{equation}
    \psi_i^{k+1} = \eta \psi_{i+1}^k + (1 - 2\eta + \Delta\tau V_i)\psi_i^k + \eta\psi_{i-1}^k\, ,
    \label{eq:evol}
\end{equation}
dove $\Delta\tau = -i\Delta t$ e $\eta = - \Delta\tau/\Delta x^2$. L'equazione \eqref{eq:evol} rappresenta l'evoluzione temporale della funzione d'onda. Come ultimo passaggio, si può definire il vettore
\begin{equation*}
    \bm{\psi}_k = (\psi_1^k,\psi_2^k,\dots,\psi_N^k)^T
\end{equation*}
e l'equazione \eqref{eq:evol} diventa
\begin{equation*}
    \bm{\psi}_{k+1} = A\bm{\psi}_k
\end{equation*}
con
\begin{equation*} 
    A = \begin{pmatrix}
    1-2\eta + \Delta\tau V_1 & \eta & 0 & \cdots & 0 \\
    \eta & 1-2\eta + \Delta\tau V_2 & \eta & \cdots & 0 \\
     0 & \eta & 1-2\eta + \Delta\tau V_3 & \cdots & 0 \\
    \vdots & \vdots & \vdots & \ddots & \eta \\
    0 & 0 & 0 & \eta & 1-2\eta + \Delta\tau V_N 
    \end{pmatrix}\, . 
\end{equation*}
La matrice $A$ è tridiagonale: ciò semplifica molto la computazione della moltiplicazione matrice per vettore. Inoltre, scrivendo $A = \mathbb{1} + i\Delta t H$, si ottiene direttamente la matrice Hamiltioniana, che è indipendente dal passo temporale $\Delta t$.

\subsection{Metodo di Crank-Nicolson}
Il metodo di Crank-Nicolson combina mezzo passo del metodo di Eulero esplicito con mezzo passo del metodo implicito. Utilizzando la matrice $H$ appena calcolata, il passo esplicito da fare è \footnote{Mentre la notazione $\bm{\psi}_k$ corrisponde a $\bm{\psi}(t)$, la notazione $\bm{\psi}_{k+1/2}$ corrisponde a $\bm{\psi}(t+\Delta t/2)$}
\begin{equation*}
    \bm{\psi}_{k+1/2} = \left(\mathbb{1} + i\frac{\Delta t}{2} H\right)\bm{\psi}_k\, ,
\end{equation*}
seguito dal passo implicito, cioè
\begin{equation*}
    \left(\mathbb{1} - i\frac{\Delta t}{2} H\right)\bm{\psi}_{k+1} = \bm{\psi}_{k+1/2}\, .
\end{equation*}
Per risolvere il passo implicito, sia $M = \left(\mathbb{1} - i\frac{\Delta t}{2} H\right)$. Come si è già visto, questa matrice è tridiagonale e può essere fattorizzata nel seguente modo:
\begin{equation*} 
    M = 
    \begin{pmatrix}
        a_1 & c_1 & 0 & 0 & \cdots \\
        e_2 & a_2 & c_2 & 0 & \cdots \\
        0 & e_3 & a_3 & c_3 & \cdots \\
        0 & 0 & e_4 & a_4 & \cdots \\
        \vdots & \vdots & \vdots & \vdots & \ddots 
    \end{pmatrix} = 
    \begin{pmatrix}
        1 & 0 & 0 & 0 & \cdots \\
        \beta_2 & 1 & 0 & 0 & \cdots \\
        0 & \beta_3 & 1 & 0 & \cdots \\
        0 & 0 & \beta_4 & 1 & \cdots \\
        \vdots & \vdots & \vdots & \vdots & \ddots 
    \end{pmatrix}
    \begin{pmatrix}
        \alpha_1 & \gamma_1 & 0 & 0 & \cdots \\
        0 & \alpha_2 & \gamma_2 & 0 & \cdots \\
        0 & 0 & \alpha_3 & \gamma_3 & \cdots \\
        0 & 0 & 0 & \alpha_4 & \cdots \\
        \vdots & \vdots & \vdots & \vdots & \ddots 
    \end{pmatrix}
    = LU\, .
\end{equation*}
Nel caso considerato, i coefficienti di $M$ sono
\begin{equation*}
    a_i = 1 + \eta - V_i \frac{\Delta\tau}{2}\, , \qquad\qquad
    c_i = e_i = -\frac{\eta}{2}
\end{equation*}
e da questi si possono ricavare quelli di $L$ e $U$ partendo da $\alpha_1 = a_1$:
\begin{equation*}
    \beta_i = -\frac{\eta}{2\alpha_{i-1}}\, ,
    \qquad
    \gamma_i = -\frac{\eta}{2}\, ,
    \qquad
    \alpha_i = a_i - \frac{\eta^2}{4\alpha_{i-1}}\, .
\end{equation*}
Infine, per risolvere $LU\mathbf{x} = \mathbf{b}$, con $\mathbf{x} = \bm{\psi}_{k+1}$ e $\mathbf{b} = \bm{\psi}_{k+1/2}$, si risolve prima ricorsivamente $L\mathbf{y} = \mathbf{b}$:
\begin{equation*}
    y_1 = b_1 \qquad y_i = b_i -\beta_i y_{i-1} \qquad i = 2,\dots,N
\end{equation*}
e poi ricorsivamente $U\mathbf{x} = \mathbf{y}$:
\begin{equation*}
    x_N = \frac{y_N}{\alpha_N} \qquad x_i = \frac{y_i}{\alpha_i} - \frac{x_{i+1}\gamma_i}{\alpha_i} \qquad i = N-1,\dots,0\, .
\end{equation*}

\section{Simulazione di particella libera}
Il caso in cui $V(x) = 0$ è quello di particella libera. Si usa come condizione iniziale $\psi(0,0) = 1$ e $\psi(x,0) = 0\ \forall x \neq 0$.

\end{document}