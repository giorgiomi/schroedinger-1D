\documentclass[a4paper, titlepage]{article}
\input{packages}

%%% Il documento vero e proprio %%%
\begin{document}
\input{frontespizio}
\newcommand{\sch}[0]{Schrödinger }

\section{Introduzione}
L'obiettivo di questo progetto è risolvere numericamente l'equazione di Schrödinger in una dimensione:
\begin{equation}
    i\frac{\partial}{\partial t}\psi(x,t) = \left[-\frac{\partial^2}{\partial x^2} + V(x)\right]\psi(x,t)\, .
    \label{eq:sch}
\end{equation}
Per semplicità, si sono posti $\hbar = m = 1$. Si è interessati alla regione $x \in [-L,L]$ e si impongono le condizioni al contorno $\psi(-L,t) = \psi(L,t) = 0$. Si vogliono studiare i casi di particella libera $V(x) = 0$ e di potenziale a doppia buca $V(x) = V_0(x^2-a^2)^2$.

\subsection{Metodo di Eulero esplicito}
Il primo approccio è quello di utilizzare il metodo di Eulero esplicito. 
Per prima cosa, si usano le differenze finite per stimare le derivate della funzione d'onda che compaiono in \eqref{eq:sch}. Siano $x = x_0 + \Delta x$ e $t = t_0 + \Delta t$, si ottiene:
\begin{align*}
    &\pdv{\psi(x, t)}{t} = \frac{\psi(x_0, t_0 + \Delta t) - \psi(x_0, t_0)}{\Delta t} + \mathcal{O}(\Delta t)\, , \\
    &\pdv[2]{\psi(x, t)}{x} = \frac{\psi(x_0 + \Delta x, t_0) - 2\psi(x_0, t_0) + \psi(x_0 - \Delta x, t)}{\Delta x^2} + \mathcal{O}(\Delta x^2)\, .
\end{align*}
L'equazione di Schrödinger diventa quindi:
\begin{equation*}
    i \frac{\psi(x_0, t_0 + \Delta t) - \psi(x_0, t_0)}{\Delta t} = 
    - \frac{\psi(x_0 + \Delta x, t_0) - 2\psi(x_0, t_0) + \psi(x_0 - \Delta x, t_0)}{\Delta x^2} + V(x_0)\psi(x_0, t_0)\, .
\end{equation*}
Prendendo $\Delta x = 2L/(N+1)$, si possono definire la funzione d'onda e il potenziale calcolati sui punti della griglia come
\begin{align*}
    &\psi_i^k = \psi(-L + i\Delta x, t_0 + k\Delta t) \qquad i = 0,1,\dots,N+1 \quad k = 0,1,\dots,M \\
    &V_i = V(-L + i\Delta x) \qquad\qquad\qquad\ i = 0,1,\dots,N+1
\end{align*}
e si può scrivere l'equazione in modo più chiaro:
\begin{equation*}
    i \frac{\psi_i^{k+1} - \psi_i^k}{\Delta t} = 
    - \frac{\psi_{i+1}^k - 2\psi_i^k + \psi_{i-1}^k}{\Delta x^2} + V_i\psi_i^k\, .
\end{equation*}
Isolando il termine $\psi_i^{k+1}$ e semplificando, si ottiene
\begin{equation}
    \psi_i^{k+1} = \eta \psi_{i+1}^k + (1 - 2\eta + \Delta\tau V_i)\psi_i^k + \eta\psi_{i-1}^k\, ,
    \label{eq:evol}
\end{equation}
dove $\Delta\tau = -i\Delta t$ e $\eta = - \Delta\tau/\Delta x^2$. L'equazione \eqref{eq:evol} rappresenta l'evoluzione temporale della funzione d'onda. Come ultimo passaggio, si può definire il vettore
\begin{equation*}
    \bm{\psi}_k = (\psi_1^k,\psi_2^k,\dots,\psi_N^k)^T
\end{equation*}
e l'equazione \eqref{eq:evol} diventa
\begin{equation}
    \bm{\psi}_{k+1} = A\bm{\psi}_k
    \label{eq:evol_mat}
\end{equation}
con
\begin{equation*} 
    A = \begin{pmatrix}
    1-2\eta + \Delta\tau V_1 & \eta & 0 & \cdots & 0 \\
    \eta & 1-2\eta + \Delta\tau V_2 & \eta & \cdots & 0 \\
     0 & \eta & 1-2\eta + \Delta\tau V_3 & \cdots & 0 \\
    \vdots & \vdots & \vdots & \ddots & \eta \\
    0 & 0 & 0 & \eta & 1-2\eta + \Delta\tau V_N 
    \end{pmatrix}\, . 
\end{equation*}
La matrice $A$ è tridiagonale: ciò semplifica molto la computazione della moltiplicazione matrice per vettore. Inoltre, scrivendo $A = \mathbb{1} + i\Delta t H$, si ottiene direttamente la matrice Hamiltioniana, che è indipendente dal passo temporale $\Delta t$.

\subsection{Metodo di Crank-Nicolson}
Il metodo di Crank-Nicolson combina mezzo passo del metodo di Eulero esplicito con mezzo passo del metodo implicito. Utilizzando la matrice $H$ appena calcolata, il passo esplicito da fare è \footnote{Mentre la notazione $\bm{\psi}_k$ corrisponde a $\bm{\psi}(t)$, la notazione $\bm{\psi}_{k+1/2}$ corrisponde a $\bm{\psi}(t+\Delta t/2)$}
\begin{equation*}
    \bm{\psi}_{k+1/2} = \left(\mathbb{1} + i\frac{\Delta t}{2} H\right)\bm{\psi}_k\, ,
\end{equation*}
seguito dal passo implicito, cioè
\begin{equation*}
    \left(\mathbb{1} - i\frac{\Delta t}{2} H\right)\bm{\psi}_{k+1} = \bm{\psi}_{k+1/2}\, .
\end{equation*}
Per risolvere il passo implicito, sia $M = \left(\mathbb{1} - i\frac{\Delta t}{2} H\right)$. Come si è già visto, questa matrice è tridiagonale e può essere fattorizzata nel seguente modo:
\begin{equation*} 
    M = 
    \begin{pmatrix}
        a_1 & c_1 & 0 & 0 & \cdots \\
        e_2 & a_2 & c_2 & 0 & \cdots \\
        0 & e_3 & a_3 & c_3 & \cdots \\
        0 & 0 & e_4 & a_4 & \cdots \\
        \vdots & \vdots & \vdots & \vdots & \ddots 
    \end{pmatrix} = 
    \begin{pmatrix}
        1 & 0 & 0 & 0 & \cdots \\
        \beta_2 & 1 & 0 & 0 & \cdots \\
        0 & \beta_3 & 1 & 0 & \cdots \\
        0 & 0 & \beta_4 & 1 & \cdots \\
        \vdots & \vdots & \vdots & \vdots & \ddots 
    \end{pmatrix}
    \begin{pmatrix}
        \alpha_1 & \gamma_1 & 0 & 0 & \cdots \\
        0 & \alpha_2 & \gamma_2 & 0 & \cdots \\
        0 & 0 & \alpha_3 & \gamma_3 & \cdots \\
        0 & 0 & 0 & \alpha_4 & \cdots \\
        \vdots & \vdots & \vdots & \vdots & \ddots 
    \end{pmatrix}
    = LU\, .
\end{equation*}
Nel caso considerato, i coefficienti di $M$ sono
\begin{equation*}
    a_i = 1 + \eta - V_i \frac{\Delta\tau}{2}\, , \qquad\qquad
    c_i = e_i = -\frac{\eta}{2}
\end{equation*}
e da questi si possono ricavare quelli di $L$ e $U$ partendo da $\alpha_1 = a_1$:
\begin{equation}
    \beta_i = -\frac{\eta}{2\alpha_{i-1}}\, ,
    \qquad
    \gamma_i = -\frac{\eta}{2}\, ,
    \qquad
    \alpha_i = a_i - \frac{\eta^2}{4\alpha_{i-1}}\, .
    \label{eq:recZ}
\end{equation}
Infine, per risolvere $LU\mathbf{x} = \mathbf{b}$, con $\mathbf{x} = \bm{\psi}_{k+1}$ e $\mathbf{b} = \bm{\psi}_{k+1/2}$, si risolve prima ricorsivamente $L\mathbf{y} = \mathbf{b}$:
\begin{equation}
    y_1 = b_1 \qquad y_i = b_i -\beta_i y_{i-1} \qquad i = 2,\dots,N
    \label{eq:recA}
\end{equation}
e poi ricorsivamente $U\mathbf{x} = \mathbf{y}$:
\begin{equation}
    x_N = \frac{y_N}{\alpha_N} \qquad x_i = \frac{y_i}{\alpha_i} - \frac{x_{i+1}\gamma_i}{\alpha_i} \qquad i = N-1,\dots,0\, .
    \label{eq:recB}
\end{equation}

\section{Simulazione di particella libera}
Il caso in cui $V(x) = 0$ è quello di particella libera. Si usa come condizione iniziale
\[
    \psi(x = 0, 0) = \frac{1}{\sqrt{\Delta x}}\, ,
    \qquad
    \psi(x,0) = 0\ \forall x \neq 0\, .
\]
Si fanno andare le simulazioni con $N = 199$ divisioni spaziali, $\Delta x = \num{1e-2}$, $L=1$, $M = \num{3e4}$ passi temporali, $\Delta t = \num{1e-6}$. 

La struttura delle simulazioni con i due metodi è semplice:
\begin{itemize}
    \item Nel caso del metodo di Eulero esplicito, ad ogni passo basta effettuare la moltiplicazione matrice per vettore di equazione \eqref{eq:evol_mat}. Come già accennato, siccome la matrice è tridiagonale, la computazione è meno dispendiosa: si tratta di un algoritmo $\mathcal{O}(N)$ invece che $\mathcal{O}(N^2)$, dove la matrice è $N\times N$.
    \item Per il metodo di Crank-Nicolson invece, per ogni passo della simulazione si esegue il mezzo passo esplicito allo stesso modo di Eulero e poi si inverte la matrice del passo implicito con le regole di ricorsione \eqref{eq:recZ}, \eqref{eq:recA} e \eqref{eq:recB}, che sono anch'esse $\mathcal{O}(N)$.
\end{itemize}

Per studiare il comportamento di entrambi i metodi, si calcola ad ogni passo temporale la normalizzazione della funzione d'onda, cioè
\[
    \mathcal{N}(t) = \int_{-L}^L |\psi(x,t)|^2 \dd{x}\, .
\]
Naturalmente ci si aspetta di avere $\mathcal{N}(t) = 1$, ma come si può notare in figura \ref{fig:norm} il metodo di Eulero viola questa condizione e $\mathcal{N}(t)$ cresce esponenzialmente!
Il problema risiede proprio nel fatto che il metodo è di tipo esplicito e, come per le equazioni differenziali ordinarie, la convergenza non è garantita. 

\begin{figure}[h!]
    \centering
    \begin{minipage}{0.47 \textwidth}
        \centering
        \includegraphics[width = \linewidth]{figures/norm.png}
        \caption{Evoluzione temporale della normalizzazione della funzione d'onda nei due metodi}
        \label{fig:norm}
    \end{minipage}
    \hspace{0.02\textwidth}
    \begin{minipage}{0.47 \textwidth}
        \centering
        \includegraphics[width = \linewidth]{figures/pos.png}
        \caption{Evoluzione temporale del valore di aspettazione $\langle x \rangle$ e di $\sigma_x$ nella simulazione con Crank-Nicolson}
        \label{fig:pos}
    \end{minipage}
\end{figure}

È conveniente dunque affidarsi al metodo di Crank-Nicolson, del quale si verifica la corretta implementazione mostrando l'evoluzione temporale del valor medio $\langle x \rangle$ e della deviazione standard $\sigma_x = \sqrt{\langle x^2 \rangle - \langle x \rangle^2}$ in figura \ref{fig:pos}.



\section{Simulazione con potenziale a doppia buca}



\end{document}